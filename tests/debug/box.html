<html>
<head>
    <script type="text/javascript" src="../../LoiraDesigner.js"></script>
    <style>
        #buttons{
            padding: 5px;
        }
        #buttons p{
            margin: 5px;
        }
        #buttons button{
            width: 100%;
        }
    </style>
</head>
<body>
<div style="width: 100%">
    <div id="buttons" style="width: 10%; float: left">
        <p>Comunes</p>
        <button id="box">Caja</button>
        <button id="showBox">Mostrar caja</button>
        <button id="delBox">Borrar caja</button>
        <button id="destroy">Destruir canvas</button>
    </div>
    <div id="genial" style="width: 85%; height: 500px; float: left; overflow: auto">
        <canvas style="background-color:#aacccc" id="_canvas" width="800" height="500" tabindex="999"></canvas>
    </div>
</div>
<script>
    window.onload = function(){

        Loira.Config.assetsPath = '../../assets/';

        var canvas = new Loira.Canvas('_canvas');
        var myObject;

        var image = new Image();
        image.src = 'test.jpg';
        image.onload = function () {
            canvas.setBackground(image, true);
        };

        canvas.setScrollContainer('genial');

        // TODO Se le da un timeout para q carguen las imagenes, se mantiene hasta encontrar otra forma solo es en la primera renderizacion
        setTimeout(function(){
            canvas.renderAll();
        }, 50);

        document.getElementById('box').addEventListener('click', function(){
            myObject = new Box.Box({x:150, y:150, text:' '});

            canvas.add([myObject, new Box.Box({x:500, y:200})]);
        });

        document.getElementById('showBox').addEventListener('click', function(){
            myObject.show();
        });

        document.getElementById('delBox').addEventListener('click', function(){
            canvas.removeAll();
        });

        document.getElementById('destroy').addEventListener('click', function(){
            canvas.destroy();
        });

        canvas.on('object:added', function(evt){
            if(evt.selected.type == 'use_case'){
                evt.selected.text = prompt("Por favor ingrese un texto", "caso de uso");
            }else if(evt.selected.type == 'actor'){
                evt.selected.text = prompt("Por favor ingrese un nombre", "actor");
            }
        });
    }
</script>
</body>
</html>
